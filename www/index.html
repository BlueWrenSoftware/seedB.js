<!DOCTYPE html>
<html lang="en-au" dir="ltr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" contnet="wdth-device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Copy SeedB</title>
  <link rel="stylesheet" href="./styles/styles.css">
</head>

<body>
  <div class="pages">
    <!-- Menu settings -->
    <section class="js-menu-hamburger">
      <img class="menu-hamburger" src="./images/hamburger_icon.svg">
      <div class="js-menu-hamburger--closed">
        <img class="menu-hamburger" src="./images/hamburger_active.svg">
        <nav class="menu-hamburger--show">
          <ul class="menu-hamburger__list">
            <li><a onclick="UI.selectPages('homePage')">Home Page - Seed List</a></li>
            <li><a onclick="UI.selectPages('newPktPage')">Enter New Seed Packet</a></li>
            <li><a onclick="UI.selectPages('readWritePage')">Read Write Data Files</a></li>
            <li><a onclick="UI.selectPages('instructionsPage')">Instructions</a></li>
        </nav>
      </div>
    </section>

    <!-- Header -->
    <section>
      <header>
        <img class="page-header__h1--logo" src="./images/bettong-june.svg" height="42">
        <h1 class="page-header__h1">
          SeedB - Seed Data Base
        </h1>
      </header>
    </section>
    
    <!-- Home Page -->
    <section id="home-page">
      <!-- Table of Records -->
      <table class="table-seeds table-seeds__row-color" id="mytable">
        <thead>
          <tr>
            <th class="sort" onclick="UI.refreshTable('seedGroup')">Seed<br>Group</th>
            <th class="sort" onclick="UI.refreshTable('variety')">Seed<br>Variety</th>
            <th class="sort" onclick="UI.refreshTable('pktId')">Seed<br>Packet Id</th>
            <th class="sort" onclick="UI.refreshTable('seedDatePacked')">Date<br>Packed</th>
            <th>Seed<br>Count</th>
            <th>Seed<br>Grams</th>
            <th>Edit</th>
          </tr>
        </thead>
        <tbody id="seed-list"></tbody>
      </table>
    </section>

    <!-- Data Entry Page -->
    <section id="edit-page">
      <header>
        <h2 class="chapter--h2">
          Seed Collection
        </h2>
        <h3 class="chapter--h3">
          Enter Seed Packets
        </h3>
      </header>
      <p>*&emsp;Input required.</p>
      <p>**&ensp;Seed Packet Id must be unique!</p>
      <form id="seed-entry">
        <br>
        <label for="seedGroup">*&nbsp;Seed&nbsp;Group: </label>
        <input type="text" id="seedGroup"><br>
        <label for="variety">*&nbsp;Variety: </label>
        <input type="text" id="variety"><br>
        <label for="pktId">**&nbsp;Seed&nbsp;Packet:</label>
        <input type="text" id="pktId"><br>
        <label for="seedNumbers">*&nbsp;Seed&nbsp;Count:</label>
        <input type="number" id="seedNumbers"><br>
        <label for="seedWeight">*&nbsp;Seed &nbsp;Grams:</label>
        <input type="number" id="seedWeight"><br>
        <label for="seedDatePacked">*&nbsp;Date&nbsp;Packaged:</label>
        <input type="date" id="seedDatePacked"><br>
        <label for="timeStamp">Timestamp:</label>
        <input type="number" readonly="readonly" class="timestamp" id="timeStamp"><br>
        <label class="notes" for="seedNotes">Notes:</label>
        <textarea rows="2" id="seedNotes"></textarea>
        <br>
        <div id="edit-pkt-buttons" class="wrapper">
          <button class="selected flex-item" type="button" onclick="Store.editAddRecord('editSeedPkt')">Submit Current
            Record</button>
          <input class="selected flex-item" type="reset" value="Cancel">
          <button class="select-delete flex-item" type="button" onclick="Store.deleteRecord()">Delete Current
            Record</button>
          <button class="selected flex-item" type="button" onclick="UI.selectPages('homePage')">Return to Seed
            List</button>
        </div>
        <div id="new-pkt-buttons" class="wrapper">
          <button class="selected flex-item" type="button" onclick="Store.editAddRecord('newPktPage')">Submit New
            Record</button>
          <input class="selected flex-item" type="reset" value="Clear Form (Data Not Saved)">
          <button class="selected flex-item" type="button" onclick="UI.selectPages('homePage')">Return to Seed
            List</button>
        </div>
      </form>
      <div id="insert-form-alerts">
        <p id="pkt-message"></p>
      </div>
    </section>

    <!-- Read Write Files Page-->
    <section id="read-write-page">
      <header>
        <h2 class="chapter--h2">
          Backup and Restore
        </h2>
      </header><br>
      <div id="retrieve-data-button">
        <h3 class="chapter--h3">
          Create Backup Text File
        </h3>
        <button class="selected" onclick="Data.retrieveAll()">Retrieve All Data from SeedB and Save as Text File</button><br><br>
      </div>
      <aside id="js-db-error"></aside>
      <h3 class="chapter--h3">
        Restore Data from Backup Text File
      </h3>
      <input type="file" name="file" id="js-input-file-data" style="display:none">
      <button id="js-file-select" class="select-delete">Upload Backup Text File Restoring All Data</button><br>
      <p id='js-msg'></p>
      
    </section>

    <!-- Instructions Page -->
    <section id="instructions-page" class="section--paragraph">
      <!-- <br>
      <p>The instruction below is a hack for the moment when the SeedB is not installed or the browser's chache was reset - deleting the SeedB.</p>
      <p>IndexedDB is not working properly after a reset of the browser?<br> 
      Click the Reinstall IndexedDB seedB button below.</p>
      <br>
      <button onclick="Store.openDB()">Reinstall IndexedDB seedB</button> -->
    </section>

    <!-- Footer -->
    <section>
      <footer id="page-footer">
        <p>Designed by Betong Applications</p>
      </footer>
    </section>

    <!-- Go to bottom of page -->
    <div id="js-page--to-bottom" onclick="UI.scrollToBottom()" title="Go To Bottom"></div>

    <!-- Go to top of page-->
    <div id="js-page--to-top" onclick="UI.scrollToTop()" title="Go to Top"></div>
  </div>
  <script src="./js/app.js"> </script>
  <script>
    function dbExist() {
      const dbexist = false;
      const request = window.indexedDB.open("seedB");
      request.onsuccess = function(e) {
        db = e.target.result;
        if (!db.objectStoreNames.contains('entity')) {
          db.close();
          //console.log("SeedB data is corrupted");
          const errorMsg = document.getElementById("js-db-error");
          errorMsg.insertAdjacentHTML("afterbegin",
          "<h3 class='chapter--h3'>SeedB missing or not working properly!</h3>" +
            "<ul>" +
              "<li>Possible cause:</li>" +
              "<li>&nbsp;&nbsp;- Browser cache was reset.</li>" +
              "<li>&nbsp;&nbsp;- Database was deleted.</li>" +
              "<li>&nbsp;&nbsp;- All records are missing</li>" +
            "</ul>" + 
            "<ul>Solution:" +
              "<li>&nbsp;&nbsp;- Reinstall SeedB.<li>" +
              "<li>&nbsp;&nbsp;- Upload backup restoring all data.<li>" +
            "</ul><br>" +
            "<h3 class='chapter--h3'>Restore Data from Backup Text File</h3>" +
            "<button  class='select-delete' onclick='Store.corruptDB()'>Reinstall SeedB</button><br><br>"
          )
          UI.selectPages("dbError");
        }
      }
    }
    //dbExist();
  </script>
</body>
</html>